# PonziLicle

**PonziLicle** is a hybrid detection framework for identifying Ponzi scheme characteristics in smart contracts. It combines static analysis and multi-aspect code explanations generated by large language models (LLMs) to accurately detect fraudulent behavior in smart contract code.

## 🔍 Features

- Analyzes smart contracts from five Ponzi-related aspects: `fund_flow`, `profit_logic`, `referral_mechanism`, `withdrawal_control`, and `camouflage`.
- Utilizes LLMs (e.g., GPT-4o, DeepSeek) to generate detailed natural language explanations.
- Leverages static analysis (via Slither) to extract interpretable contract-level signals.
- Aligns LLM explanations with static results to mitigate hallucination.
- Combines explanations, static signals, and source code for supervised model training.
- Provides statistical analysis to validate the relevance of each feature.

---

## 📁 Project Structure

```
.
├── ponzi_plugin.py                # Plugin to combine LLM and static explanations
├── PonziDetector.py              # Static detection rules for five Ponzi features
├── generate_llm_explaination.py  # Batch LLM explanation generation
├── generate_static_analysis.py   # Static signal extraction using Slither
├── train.py                      # Classification model with fusion module
├── run.py                        # Main script to train classifier
├── StatisticalAnalysis.py        # Statistical significance tests and plots
└── Results/                      # Output folder for training and evaluation
```

---

## ⚙️ Installation

```bash
python -m venv venv
source venv/bin/activate   # or .\venv\Scripts\activate on Windows
pip install -r requirements.txt
```

**Sample `requirements.txt`:**
```
openai
transformers
torch
scikit-learn
slither-analyzer
pandas
tqdm
matplotlib
seaborn
```

---

## 🚀 Usage

### Step 1: Perform Static Analysis

```bash
python generate_static_analysis.py
```

### Step 2: Generate LLM Explanations

```bash
python generate_llm_explaination.py
```

### Step 3: Train Detection Model

```bash
python run.py \
    --code_model_path codet5 \
    --nl_model_path codet5 \
    --epoch 50 \
    --batch_size 4 \
    --savepath ./Results
```

### Step 5: Statistical Validation

```bash
python StatisticalAnalysis.py
```

---

## 🧠 Ponzi Behavior Aspects

1. **fund_flow**: Redirection of user funds to prior participants.
2. **profit_logic**: Profit depends on deposits from new users or fixed multipliers.
3. **referral_mechanism**: Presence of inviter, referrer, or hierarchy-based rewards.
4. **withdrawal_control**: Lock-ups, time checks, or other withdrawal restrictions.
5. **camouflage**: Misleading naming (e.g., "staking", "mining") for hidden purposes.
